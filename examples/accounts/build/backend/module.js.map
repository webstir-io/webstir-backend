{
  "version": 3,
  "sources": ["../../src/backend/module.ts"],
  "sourcesContent": ["import { initContract } from '@ts-rest/core';\nimport { createModule, fromTsRestRouter, type RequestContext, type SSRContext } from '@webstir-io/module-contract';\nimport { z } from 'zod';\n\ntype Account = {\n  id: string;\n  email: string;\n};\n\ntype AccountsDatabase = {\n  accounts: {\n    list: () => Promise<Account[]>;\n    findById: (id: string) => Promise<Account | undefined>;\n  };\n};\n\ntype AccountsContext = RequestContext<unknown, unknown, unknown, unknown, AccountsDatabase>;\n\nconst c = initContract();\n\nconst accountSchema = z.object({\n  id: z.string().uuid(),\n  email: z.string().email()\n});\n\nconst router = c.router({\n  list: c.query({\n    path: '/accounts',\n    method: 'GET',\n    responses: {\n      200: z.object({ data: z.array(accountSchema) })\n    }\n  }),\n  detail: c.query({\n    path: '/accounts/:id',\n    method: 'GET',\n    pathParams: z.object({ id: z.string().uuid() }),\n    responses: {\n      200: accountSchema,\n      404: z.null()\n    }\n  })\n});\n\nconst routeSpecs = fromTsRestRouter<AccountsContext>({\n  router,\n  baseName: 'accounts',\n  createRoute: ({ keyPath }) => ({\n    handler: async (ctx) => {\n      if (keyPath.at(-1) === 'detail') {\n        const row = await ctx.db.accounts.findById(ctx.params.id);\n        return row\n          ? { status: 200, body: row }\n          : { status: 404, errors: [{ code: 'not_found', message: 'Account not found' }] };\n      }\n\n      const rows = await ctx.db.accounts.list();\n      return { status: 200, body: { data: rows } };\n    }\n  })\n});\n\nexport const module = createModule<AccountsContext, SSRContext>({\n  manifest: {\n    contractVersion: '1.0.0',\n    name: '@demo/accounts',\n    version: '0.1.0',\n    kind: 'backend',\n    capabilities: ['db', 'auth'],\n    routes: routeSpecs.map((route) => route.definition)\n  },\n  routes: routeSpecs\n});\n"],
  "mappings": "AAAA,SAAS,oBAAoB;AAC7B,SAAS,cAAc,wBAA8D;AACrF,SAAS,SAAS;AAgBlB,MAAM,IAAI,aAAa;AAEvB,MAAM,gBAAgB,EAAE,OAAO;AAAA,EAC7B,IAAI,EAAE,OAAO,EAAE,KAAK;AAAA,EACpB,OAAO,EAAE,OAAO,EAAE,MAAM;AAC1B,CAAC;AAED,MAAM,SAAS,EAAE,OAAO;AAAA,EACtB,MAAM,EAAE,MAAM;AAAA,IACZ,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,WAAW;AAAA,MACT,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,aAAa,EAAE,CAAC;AAAA,IAChD;AAAA,EACF,CAAC;AAAA,EACD,QAAQ,EAAE,MAAM;AAAA,IACd,MAAM;AAAA,IACN,QAAQ;AAAA,IACR,YAAY,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;AAAA,IAC9C,WAAW;AAAA,MACT,KAAK;AAAA,MACL,KAAK,EAAE,KAAK;AAAA,IACd;AAAA,EACF,CAAC;AACH,CAAC;AAED,MAAM,aAAa,iBAAkC;AAAA,EACnD;AAAA,EACA,UAAU;AAAA,EACV,aAAa,CAAC,EAAE,QAAQ,OAAO;AAAA,IAC7B,SAAS,OAAO,QAAQ;AACtB,UAAI,QAAQ,GAAG,EAAE,MAAM,UAAU;AAC/B,cAAM,MAAM,MAAM,IAAI,GAAG,SAAS,SAAS,IAAI,OAAO,EAAE;AACxD,eAAO,MACH,EAAE,QAAQ,KAAK,MAAM,IAAI,IACzB,EAAE,QAAQ,KAAK,QAAQ,CAAC,EAAE,MAAM,aAAa,SAAS,oBAAoB,CAAC,EAAE;AAAA,MACnF;AAEA,YAAM,OAAO,MAAM,IAAI,GAAG,SAAS,KAAK;AACxC,aAAO,EAAE,QAAQ,KAAK,MAAM,EAAE,MAAM,KAAK,EAAE;AAAA,IAC7C;AAAA,EACF;AACF,CAAC;AAEM,MAAM,SAAS,aAA0C;AAAA,EAC9D,UAAU;AAAA,IACR,iBAAiB;AAAA,IACjB,MAAM;AAAA,IACN,SAAS;AAAA,IACT,MAAM;AAAA,IACN,cAAc,CAAC,MAAM,MAAM;AAAA,IAC3B,QAAQ,WAAW,IAAI,CAAC,UAAU,MAAM,UAAU;AAAA,EACpD;AAAA,EACA,QAAQ;AACV,CAAC;",
  "names": []
}
